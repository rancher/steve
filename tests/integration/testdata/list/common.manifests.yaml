# Local namespace for Rancher resources
apiVersion: v1
kind: Namespace
metadata:
  name: local
---
# Projects (need a backing namespace - using local cluster pattern)
apiVersion: management.cattle.io/v3
kind: Project
metadata:
  name: test-prj-1
  namespace: local
spec:
  clusterName: local
  displayName: Test Project 1
---
apiVersion: management.cattle.io/v3
kind: Project
metadata:
  name: test-prj-2
  namespace: local
spec:
  clusterName: local
  displayName: Test Project 2
---
apiVersion: v1
kind: Namespace
metadata:
  name: test-ns-1
  labels:
    field.cattle.io/projectId: test-prj-1
---
apiVersion: v1
kind: Namespace
metadata:
  name: test-ns-2
  labels:
    field.cattle.io/projectId: test-prj-1
---
apiVersion: v1
kind: Namespace
metadata:
  name: test-ns-3
  labels:
    field.cattle.io/projectId: test-prj-1
---
apiVersion: v1
kind: Namespace
metadata:
  name: test-ns-4
  labels:
    field.cattle.io/projectId: test-prj-1
---
apiVersion: v1
kind: Namespace
metadata:
  name: test-ns-5
  labels:
    field.cattle.io/projectId: test-prj-1
---
apiVersion: v1
kind: Namespace
metadata:
  name: test-ns-6
  labels:
    field.cattle.io/projectId: test-prj-2
---
apiVersion: v1
kind: Namespace
metadata:
  name: test-ns-7
  labels:
    field.cattle.io/projectId: test-prj-2
---
apiVersion: v1
kind: Namespace
metadata:
  name: test-ns-8
---
apiVersion: v1
kind: Namespace
metadata:
  name: test-ns-9
---
# ClusterRole for full secret access (used by user-a, user-d, user-e)
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: secret-reader
rules:
- apiGroups: [""]
  resources: ["secrets"]
  verbs: ["get", "list"]
---
# Role for limited secret access (test1, test2 only) - needs to be in each namespace
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: mixed-secret-user
  namespace: test-ns-1
rules:
- apiGroups: [""]
  resources: ["secrets"]
  resourceNames: ["test1", "test2"]
  verbs: ["get", "list"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: mixed-secret-user
  namespace: test-ns-2
rules:
- apiGroups: [""]
  resources: ["secrets"]
  resourceNames: ["test1", "test2"]
  verbs: ["get", "list"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: mixed-secret-user
  namespace: test-ns-3
rules:
- apiGroups: [""]
  resources: ["secrets"]
  resourceNames: ["test1", "test2"]
  verbs: ["get", "list"]
---
# user-a: access to ns-1 through ns-5 (project-1 equivalent)
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-a-secrets
  namespace: test-ns-1
subjects:
- kind: User
  name: user-a
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-a-secrets
  namespace: test-ns-2
subjects:
- kind: User
  name: user-a
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-a-secrets
  namespace: test-ns-3
subjects:
- kind: User
  name: user-a
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-a-secrets
  namespace: test-ns-4
subjects:
- kind: User
  name: user-a
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-a-secrets
  namespace: test-ns-5
subjects:
- kind: User
  name: user-a
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
---
# user-b: access to ns-1 only
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-b-secrets
  namespace: test-ns-1
subjects:
- kind: User
  name: user-b
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
---
# user-c: mixed-secret-user in ns-1, ns-2, ns-3 (only test1, test2)
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-c-secrets
  namespace: test-ns-1
subjects:
- kind: User
  name: user-c
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: Role
  name: mixed-secret-user
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-c-secrets
  namespace: test-ns-2
subjects:
- kind: User
  name: user-c
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: Role
  name: mixed-secret-user
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-c-secrets
  namespace: test-ns-3
subjects:
- kind: User
  name: user-c
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: Role
  name: mixed-secret-user
  apiGroup: rbac.authorization.k8s.io
---
# user-d: access to ns-1 through ns-9 (both projects + ns-8, ns-9)
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-d-secrets
  namespace: test-ns-1
subjects:
- kind: User
  name: user-d
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-d-secrets
  namespace: test-ns-2
subjects:
- kind: User
  name: user-d
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-d-secrets
  namespace: test-ns-3
subjects:
- kind: User
  name: user-d
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-d-secrets
  namespace: test-ns-4
subjects:
- kind: User
  name: user-d
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-d-secrets
  namespace: test-ns-5
subjects:
- kind: User
  name: user-d
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-d-secrets
  namespace: test-ns-6
subjects:
- kind: User
  name: user-d
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-d-secrets
  namespace: test-ns-7
subjects:
- kind: User
  name: user-d
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-d-secrets
  namespace: test-ns-8
subjects:
- kind: User
  name: user-d
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-d-secrets
  namespace: test-ns-9
subjects:
- kind: User
  name: user-d
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
---
# user-e: access to all test namespaces (simulates cluster-owner without system namespace access)
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-e-secrets
  namespace: test-ns-1
subjects:
- kind: User
  name: user-e
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-e-secrets
  namespace: test-ns-2
subjects:
- kind: User
  name: user-e
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-e-secrets
  namespace: test-ns-3
subjects:
- kind: User
  name: user-e
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-e-secrets
  namespace: test-ns-4
subjects:
- kind: User
  name: user-e
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-e-secrets
  namespace: test-ns-5
subjects:
- kind: User
  name: user-e
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-e-secrets
  namespace: test-ns-6
subjects:
- kind: User
  name: user-e
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-e-secrets
  namespace: test-ns-7
subjects:
- kind: User
  name: user-e
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-e-secrets
  namespace: test-ns-8
subjects:
- kind: User
  name: user-e
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-e-secrets
  namespace: test-ns-9
subjects:
- kind: User
  name: user-e
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
---
apiVersion: v1
kind: Secret
metadata:
  name: test1
  namespace: test-ns-1
---
apiVersion: v1
kind: Secret
metadata:
  name: test2
  namespace: test-ns-1
  labels:
    test-label: '2'
---
apiVersion: v1
kind: Secret
metadata:
  name: test3
  namespace: test-ns-1
  labels:
    test-label-gte: '3'
---
apiVersion: v1
kind: Secret
metadata:
  name: test4
  namespace: test-ns-1
  labels:
    test-label-gte: '3'
---
apiVersion: v1
kind: Secret
metadata:
  name: test5
  namespace: test-ns-1
  labels:
    test-label-gte: '3'
---
apiVersion: v1
kind: Secret
metadata:
  name: test1
  namespace: test-ns-2
---
apiVersion: v1
kind: Secret
metadata:
  name: test2
  namespace: test-ns-2
  labels:
    test-label: '2'
---
apiVersion: v1
kind: Secret
metadata:
  name: test3
  namespace: test-ns-2
  labels:
    test-label-gte: '3'
---
apiVersion: v1
kind: Secret
metadata:
  name: test4
  namespace: test-ns-2
  labels:
    test-label-gte: '3'
  annotations:
    management.cattle.io/project-scoped-secret-copy: spuds
---
apiVersion: v1
kind: Secret
metadata:
  name: test5
  namespace: test-ns-2
  labels:
    test-label-gte: '3'
---
apiVersion: v1
kind: Secret
metadata:
  name: test1
  namespace: test-ns-3
---
apiVersion: v1
kind: Secret
metadata:
  name: test2
  namespace: test-ns-3
  labels:
    test-label: '2'
---
apiVersion: v1
kind: Secret
metadata:
  name: test3
  namespace: test-ns-3
  labels:
    test-label-gte: '3'
---
apiVersion: v1
kind: Secret
metadata:
  name: test4
  namespace: test-ns-3
  labels:
    test-label-gte: '3'
---
apiVersion: v1
kind: Secret
metadata:
  name: test5
  namespace: test-ns-3
  labels:
    test-label-gte: '3'
---
apiVersion: v1
kind: Secret
metadata:
  name: test1
  namespace: test-ns-4
---
apiVersion: v1
kind: Secret
metadata:
  name: test2
  namespace: test-ns-4
  labels:
    test-label: '2'
---
apiVersion: v1
kind: Secret
metadata:
  name: test3
  namespace: test-ns-4
  labels:
    test-label-gte: '3'
---
apiVersion: v1
kind: Secret
metadata:
  name: test4
  namespace: test-ns-4
  labels:
    test-label-gte: '3'
---
apiVersion: v1
kind: Secret
metadata:
  name: test5
  namespace: test-ns-4
  labels:
    test-label-gte: '3'
---
apiVersion: v1
kind: Secret
metadata:
  name: test1
  namespace: test-ns-5
---
apiVersion: v1
kind: Secret
metadata:
  name: test2
  namespace: test-ns-5
  labels:
    test-label: '2'
---
apiVersion: v1
kind: Secret
metadata:
  name: test3
  namespace: test-ns-5
  labels:
    test-label-gte: '3'
---
apiVersion: v1
kind: Secret
metadata:
  name: test4
  namespace: test-ns-5
  labels:
    test-label-gte: '3'
---
apiVersion: v1
kind: Secret
metadata:
  name: test5
  namespace: test-ns-5
  labels:
    test-label-gte: '3'
---
apiVersion: v1
kind: Secret
metadata:
  name: test1
  namespace: test-ns-6
---
apiVersion: v1
kind: Secret
metadata:
  name: test2
  namespace: test-ns-6
  labels:
    test-label: '2'
---
apiVersion: v1
kind: Secret
metadata:
  name: test1
  namespace: test-ns-7
---
apiVersion: v1
kind: Secret
metadata:
  name: test2
  namespace: test-ns-7
  labels:
    test-label: '2'
---
apiVersion: v1
kind: Secret
metadata:
  name: test1
  namespace: test-ns-8
---
apiVersion: v1
kind: Secret
metadata:
  name: test2
  namespace: test-ns-8
  labels:
    test-label: '2'
---
apiVersion: v1
kind: Secret
metadata:
  name: test1
  namespace: test-ns-9
---
apiVersion: v1
kind: Secret
metadata:
  name: test2
  namespace: test-ns-9
  labels:
    test-label: '2'
